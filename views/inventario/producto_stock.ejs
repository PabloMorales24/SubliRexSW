<%- include('../partials/header') %>

<link  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

<style>
  .prod-card{border:1px solid #dee2e6;border-radius:.8rem;padding:1.2rem;background:#fff}
  .prod-img{width:100%;max-height:180px;object-fit:contain;margin-bottom:.5rem}
  th,td{vertical-align:middle}
</style>

<div class="container my-4">

  <h1 class="text-center fw-bold"><%= producto.nombre %></h1>
  <% if(producto.descripcion){ %>
    <p class="text-center text-muted mb-4"><%= producto.descripcion %></p>
  <% } %>

  <div class="row g-4">

    <aside class="col-lg-4">
      <div class="prod-card">
        <% if(producto.imagen){ %>
          <img src="<%= producto.imagen %>" class="prod-img" alt="Producto">
        <% } %>
        <p class="fw-bold mb-2">Producto</p>
        <p class="mb-1"><strong>Marca:</strong> <%= producto.marca||'—' %></p>
        <p class="mb-1"><strong>Material:</strong> <%= producto.material||'—' %></p>
        <p class="mb-1"><strong>Color:</strong> <%= producto.color||'—' %></p>
        <p class="mb-1"><strong>Forma:</strong> <%= producto.forma||'—' %></p>
        <% if(producto.capacidad){ %>
          <p class="mb-1"><strong>Capacidad:</strong> <%= producto.capacidad %> <%= producto.unidad||'' %></p>
        <% } %>
        <% if(producto.precio_venta){ %>
          <p class="mb-0"><strong>Precio Venta Sugerido:</strong> Q <%= (+producto.precio_venta).toFixed(2) %></p>
        <% } %>
      </div>
    </aside>

    <section class="col-lg-8">

      <h4 class="border-bottom pb-2 mb-3">Existencias por bodega</h4>
      <table class="table table-sm table-bordered mb-4">
        <thead class="table-light">
          <tr><th>Bodega</th><th class="text-end">Stock Disponible</th></tr>
        </thead>
        <tbody>
          <% stocks.forEach(r=>{ %>
            <tr>
              <td><%= r.bodega %></td>
              <td class="text-end"><%= r.cantidad %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>

      <h4 class="border-bottom pb-2 mb-3">Histórico de precios por proveedor</h4>
      <table class="table table-sm table-striped table-bordered">
        <thead class="table-light">
          <tr>
            <th>Proveedor</th>
            <th>Fecha Vigencia</th>
            <th class="text-end">Precio Compra&nbsp;(Q)</th>
            <th class="text-end">Precio Venta&nbsp;(Q)</th>
          </tr>
        </thead>
        <tbody>
          <% precios.forEach(p=>{ %>
            <tr>
              <td><%= p.proveedor %></td>
              <td><%= p.fecha_vigencia.toISOString().substring(0,10) %></td>
              <td class="text-end"><%= (+p.precio_compra).toFixed(2) %></td>
              <td class="text-end"><%= (+p.precio_venta ).toFixed(2) %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>

      <a href="/inventario/stock" class="btn btn-secondary">
        <i class="fa fa-arrow-left"></i> Volver al listado
      </a>
    </section>
  </div>
</div>

<%- include('../partials/footer') %>
    